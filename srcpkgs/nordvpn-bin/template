# Template file for 'nordvpn-bin'
pkgname=nordvpn-bin
version=3.0.0v4
revision=1
archs="i686 x86_64 aarch64 armv7l armv6l"
build_style=fetch
short_desc="NordVPN CLI tool for Linux"
maintainer="Kyle Nusbaum <knusbaum+void@sdf.org>"
license="custom"
homepage="https://nordvpn.com"
nopie=true

case "$XBPS_TARGET_MACHINE" in
	x86_64)
		_deb="nordvpn_${version//v/-}_amd64.deb"
		distfiles="https://repo.nordvpn.com/deb/nordvpn/debian/pool/main/nordvpn_${version//v/-}_amd64.deb"
		checksum=a4a9602a9ecc1b29eb4ef9667993bd68999f42fc1962588951845a797d31ecfa
		;;
	i686)
		_deb="nordvpn_${version//v/-}_i386.deb"
		distfiles="https://repo.nordvpn.com/deb/nordvpn/debian/pool/main/nordvpn_${version//v/-}_i386.deb"
		checksum=2e00ae9e8cf5732a35712066ff72eac1e99149eb219e626151ec7f78be562ab1
		;;
	aarch64)
		_deb="nordvpn_${version//v/-}_aarch64.deb"
		distfiles="https://repo.nordvpn.com/deb/nordvpn/debian/pool/main/nordvpn_${version//v/-}_aarch64.deb"
		checksum=a36d8f0249125912ca0a8655a9b1a5c5615245ee3a53cc0469913e9f11c2226a
		;;
	armv7l)
		_deb="nordvpn_${version//v/-}_armhf.deb"
		distfiles="https://repo.nordvpn.com/deb/nordvpn/debian/pool/main/nordvpn_${version//v/-}_armhf.deb"
		checksum=faa61bda229abcea5defcb4cbce92f09d269ffad2918de8f9d1529ce64d2b558
		;;
	armv6l)
		_deb="nordvpn_${version//v/-}_armel.deb"
		distfiles="https://repo.nordvpn.com/deb/nordvpn/debian/pool/main/nordvpn_${version//v/-}_armel.deb"
		checksum=3203ad6ec2d19f75b4b8219cac48991fb5c13122ac0dabaa3d90d234f3b64162
		;;
esac

do_install() {

	ar p "${_deb}" data.tar.xz > data.tar.xz
	tar -C "${DESTDIR}" -xJf data.tar.xz

	mv "${DESTDIR}/usr/sbin/nordvpnsd" "${DESTDIR}/usr/bin"
	mv "${DESTDIR}/usr/sbin/nordvpnud" "${DESTDIR}/usr/bin"
	rm -r "${DESTDIR}/usr/sbin"
}
